function GetDateString(a){if (null == a || "" == a)return""; var b = new formatTimeZone(a, 8), e = b.getDate(), d = b.getMonth() + 1, c = b.getFullYear(); return isNaN(c) || isNaN(d) || isNaN(c)?"":padLeft(c, "4") + "/" + padLeft(d, "2") + "/" + padLeft(e, "2")}function GetDateTimeString(b){if (null == b || "" == b)return""; var a = new formatTimeZone(b, 8), h = a.getDate(), d = a.getMonth() + 1, c = a.getFullYear(), e = a.getHours(), f = a.getMinutes(), g = a.getSeconds(); return isNaN(c) || isNaN(d) || isNaN(c) || isNaN(e) || isNaN(f) || isNaN(g)?"":padLeft(c, "4") + "/" + padLeft(d, "2") + "/" + padLeft(h, "2") + " " + padLeft(e, "2") + ":" + padLeft(f, "2") + ":" + padLeft(g, "2")}function GetDateTimeString2(b){if (null == b || "" == b)return""; var a = new formatTimeZone(b, 8), g = a.getDate(), d = a.getMonth() + 1, c = a.getFullYear(), e = a.getHours(), f = a.getMinutes(); return isNaN(c) || isNaN(d) || isNaN(c) || isNaN(e) || isNaN(f)?"":padLeft(c, "4") + "/" + padLeft(d, "2") + "/" + padLeft(g, "2") + " " + padLeft(e, "2") + ":" + padLeft(f, "2")}function padLeft(a, b){return a.toString().length >= b?a:padLeft("0" + a.toString(), b)}function formatTimeZone(b, c){var a = new Date(b), d = a.getTime(), e = 6e4 * a.getTimezoneOffset(); return new Date(d + e + 36e5 * c)}function brand_alert(a, b, c = "question", d = ""){Swal.fire({title:a, text:b, icon:c, allowOutsideClick:!1, heightAuto:!1, buttonsStyling:!1, customClass:{confirmButton:"btn btn-primary"}}).then(a => {"" != d && (location.href = d)})}function success_brand_alert(a, b, c = ""){brand_alert(a, b, "success", c)}function error_brand_alert(a, b, c = ""){brand_alert(a, b, "error", "", c)}function warning_brand_alert(a, b, c = ""){brand_alert(a, b, "warning", c)}function info_brand_alert(a, b, c = ""){brand_alert(a, b, "info", c)}function question_brand_alert(a, b, c = ""){brand_alert(a, b, "question", c)}function delete_alert(b, a, c, d){var a = a.toString().replace(/-/g, ""); Swal.fire({title:"\u522A\u9664" + b, text:"\u78BA\u5B9A\u8981\u522A\u9664 (" + a + ")" + c + "?", icon:"warning", allowOutsideClick:!1, showConfirmButton:!0, confirmButtonText:"\u78BA\u5B9A!", showCancelButton:!0, cancelButtonText:"\u53D6\u6D88", reverseButtons:!0, buttonsStyling:!1, customClass:{confirmButton:"btn btn-danger", cancelButton:"btn btn-secondary mr-5"}}).then(b => {b.isConfirmed && $.ajax({url:"_admin_del_ajax.php", type:"POST", data:"delete_url=" + d + "/" + a, dataType:"json", success:function(b){!0 == b.result?success_brand_alert("\u522A\u9664\u6210\u529F", "(" + a + ")" + c + "-\u5DF2\u522A\u9664", location):error_brand_alert("\u522A\u9664\u5931\u6557", b.msg)}, error:function(){error_brand_alert("\u522A\u9664\u8CC7\u6599\u767C\u751F\u932F\u8AA4", "\u8ACB\u518D\u8A66\u4E00\u6B21")}})})}function brand_toast(a, b = "question"){Swal.mixin({toast:!0, position:"top-end", showConfirmButton:!1, timer:3e3}).fire({icon:b, title:a})}function success_brand_toast(a){brand_toast(a, "success")}function error_brand_toast(a){brand_toast(a, "error", "")}function warning_brand_toast(a){brand_toast(a, "warning")}function info_brand_toast(a){brand_toast(a, "info")}function question_brand_toast(a){brand_toast(a, "question")}function GetStatusColorString(b, a){switch (b){case"0":a.color = "success", a.string = "\u555F\u7528"; break; case"1":a.color = "danger", a.string = "\u505C\u7528"; break; default:a.color = "warning", a.string = "\u672A\u77E5"}}function GetBlankColorString(b, a){switch (b){case"0":a.color = "danger", a.string = "\u5426"; break; case"1":a.color = "success", a.string = "\u662F"; break; default:a.color = "warning", a.string = "\u672A\u77E5"}}function GetHomepageShowColorString(b, a){switch (b){case"0":a.color = "danger", a.string = "\u5426"; break; case"1":a.color = "success", a.string = "\u662F"; break; default:a.color = "warning", a.string = "\u672A\u77E5"}}function GetMemberStatusColorString(b, a){switch (b){case"0":a.color = "success", a.string = "\u555F\u7528"; break; case"1":a.color = "warning", a.string = "\u5C1A\u672A\u9A57\u8B49"; break; case"2":a.color = "danger", a.string = "\u505C\u7528"; break; default:a.color = "warning", a.string = "\u672A\u77E5"}}function GetContactStatusColorString(b, a){switch (b){case"0":a.color = "danger", a.string = "\u5C1A\u672A\u8655\u7406"; break; case"1":a.color = "warning", a.string = "\u8655\u7406\u4E2D"; break; case"2":a.color = "success", a.string = "\u5DF2\u8655\u7406"; break; default:a.color = "gray", a.string = "\u672A\u77E5"}}function GetLoginTypeColorString(b, a){switch (b){case"0":a.color = "success", a.string = "\u7CFB\u7D71\u9A57\u8B49"; break; case"1":a.color = "danger", a.string = "LDAP\u9A57\u8B49"; break; default:a.color = "gray", a.string = "\u672A\u77E5"}}function form_submit(a){if ("undefined" != typeof CKEDITOR)for (instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement(); $(a).removeClass("validating"), !0 === $(a).validationEngine("validate") && $(a).submit()}function query_form_submit(a){$(a).submit()}function query_form_clear(a){$(a).find("input").val(""), $(a).find("select").val(""), $(a).find(".form-control.select2").each(function(a){$(this).prop("selectedIndex", 0).change()}), query_form_submit(a)}function validate_form_submit(a){if ("undefined" != typeof CKEDITOR)for (instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement(); $(a).removeClass("validating"), !0 === $(a).validationEngine("validate") && ($(".submit_btn").attr("disabled", !0), $(a).submit())}function validate_form_submit_result(){$(".submit_btn").attr("disabled", !1)}function AJAX(a, b, c, e){var d = !1; return $.ajax({url:a, type:b, data:c, async:!1, success:function(a){e.data = a, d = !0}, error:function(a, b, c){e.data = a.responseText, d = !1}}), d}$(".select2").select2({minimumResultsForSearch:1 / 0}), $(".select2-hide-dropdown").on("select2:opening", function(a){return!1}), void 0 !== window.daterangepicker && ($(".yearmonth-picker").datepicker({format:"yyyy-mm", startView:"months", minViewMode:"months", language:"zh-TW", autoclose:!0}), $(".yearmonth-picker").datepicker().on("show.bs.modal", function(a){a.stopPropagation()}), $(".date-picker").daterangepicker({singleDatePicker:!0, showDropdowns:!0, timePicker:!1, autoUpdateInput:!1, locale:{format:"YYYY/MM/DD", applyLabel:"\u78BA\u5B9A", cancelLabel:"\u53D6\u6D88", fromLabel:"\u958B\u59CB\u65E5\u671F", toLabel:"\u7D50\u675F\u65E5\u671F", customRangeLabel:"\u81EA\u8A02\u65E5\u671F\u5340\u9593", daysOfWeek:["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"], monthNames:["1\u6708", "2\u6708", "3\u6708", "4\u6708", "5\u6708", "6\u6708", "7\u6708", "8\u6708", "9\u6708", "10\u6708", "11\u6708", "12\u6708"], firstDay:0}}), $(".date-picker").on("apply.daterangepicker", function(b, a){$(this).val(a.startDate.format("YYYY/MM/DD"))}), $(".date-picker").on("cancel.daterangepicker", function(a, b){$(this).val("")}), $(".datetime-picker").daterangepicker({singleDatePicker:!0, showDropdowns:!0, timePicker:!0, timePicker24Hour:!0, timePickerSeconds:!0, autoUpdateInput:!1, locale:{format:"YYYY/MM/DD", applyLabel:"\u78BA\u5B9A", cancelLabel:"\u53D6\u6D88", fromLabel:"\u958B\u59CB\u65E5\u671F", toLabel:"\u7D50\u675F\u65E5\u671F", customRangeLabel:"\u81EA\u8A02\u65E5\u671F\u5340\u9593", daysOfWeek:["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"], monthNames:["1\u6708", "2\u6708", "3\u6708", "4\u6708", "5\u6708", "6\u6708", "7\u6708", "8\u6708", "9\u6708", "10\u6708", "11\u6708", "12\u6708"], firstDay:0}}), $(".datetime-picker").on("apply.daterangepicker", function(b, a){$(this).val(a.startDate.format("YYYY/MM/DD HH:mm:ss"))}), $(".datetime-picker").on("cancel.daterangepicker", function(a, b){$(this).val("")}), $(".daterange-picker").daterangepicker({locale:{format:"YYYY/MM/DD", applyLabel:"\u78BA\u5B9A", cancelLabel:"\u53D6\u6D88", fromLabel:"\u958B\u59CB\u65E5\u671F", toLabel:"\u7D50\u675F\u65E5\u671F", customRangeLabel:"\u81EA\u8A02\u65E5\u671F\u5340\u9593", daysOfWeek:["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"], monthNames:["1\u6708", "2\u6708", "3\u6708", "4\u6708", "5\u6708", "6\u6708", "7\u6708", "8\u6708", "9\u6708", "10\u6708", "11\u6708", "12\u6708"], firstDay:0}})), $(".upper").keyup(function(){$(this).val($(this).val().toUpperCase())}), $(".lower").keyup(function(a){$(this).val($(this).val().toLowerCase())}), $(".look_password_btn").click(function(){var a = $(this).closest(".input-group").children("input"); return a && ("password" == a.attr("type")?(a.attr("type", "text"), $(this).empty(), $(this).append("<i class='fas fa-eye-slash'></i>")):(a.attr("type", "password"), $(this).empty(), $(this).append("<i class='fas fa-eye'></i>"))), !1}), String.format = function(){for (var b = arguments[0], a = 0; a < arguments.length - 1; a++){var c = new RegExp("\\{" + a + "\\}", "gm"); b = b.replace(c, arguments[a + 1])}return b}; var CSVToArray = function(f, a){a = a || ","; for (var g = new RegExp("(\\" + a + '|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\' + a + "\\r\\n]*))", "gi"), c = [[]], b = null; b = g.exec(f); ){var d = b[1]; if (d.length && d != a && c.push([]), b[2])var e = b[2].replace(new RegExp('""', "g"), '"');  else var e = b[3]; c[c.length - 1].push(e)}return c}; function redir(a){location.href = a}function GetYoutubeVideoID(a){return void 0 !== (a = a.replace(/(>|<)/gi, "").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?a[2].split(/[^0-9a-z_\-]/i)[0]:""}function GetYoutubeVideoPicture(a){return"https://img.youtube.com/vi/" + a + "/maxresdefault.jpg"}function isAbsoluteURL(a){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(a)}function RefreshSelect2(f, g, h, c, i, e = ""){var a = ""; if ("" != e && (a = "<option value=''>" + e + "</option>"), h){var j = "../webapi/" + f + "?query=" + encodeURIComponent(g), b = new Object; if (!0 === AJAX(j, "GET", null, b) && null !== b.data.ResultData){var k = b.data.ResultData.length, d = b.data.ResultData; for (i = 0; i < k; i++)a += "<option value=" + d[i].id, d[i].id === i && (a += " selected='selected'"), a += ">", a += d[i].name, a += "</option>"}}$(c).select2("destroy"), $(c).html(a), $(c).select2({minimumResultsForSearch:1 / 0})}